 
Scenario: Need to change user password or root password on multiple servers.  

Solution:  Automate this process using ansible playbook.  

  

Inventory file 

# cat /etc/ansible/hosts 

[devservers] 

devserver1 

devserver2 

devserver3 

devserver4 

  

[testservers] 

testserver1 

testserver2 

  

[webservers] 

webnode1 

webnode2 

  

  

Generate password hash using python 

# python -c 'import crypt,getpass; print crypt.crypt(getpass.getpass())' 

  

  

variable file 

# cat /etc/ansible/group_var/update_userpass.yml 

  

 --- 

   user_name: root 

   user_hashed_pass: HasheduserPass 

  

  

Note: You can replace HasheduserPass by hash value generated by above python command.  

  

Playbook 

# cat /etc/ansible/playbook_userpasschng.yml 

  

--- 

- name: playbook for changing root or user password on multiple servers 

   hosts: all 

   become: yes 

   vars_files:  

      - group_var/update_userpass.yml 

  

   tasks: 

     - name: user or root password change 

       user:  

          name={{ user_name }} 

          update_password=always 

          password="{{ user_hashed_pass }}" 

  

  

  

 